---
import Layout from '../layouts/Layout.astro';
import GuidedTutorial from '../components/GuidedTutorial';
---

<Layout>
	<div class="container mx-auto px-4 py-8 max-w-4xl">
		<!-- Hero Section -->
		<div class="text-center mb-12">
			<img
				src="/sd-sk-logo.webp"
				alt="Skeleton Key Logo"
				class="mx-auto mb-6 max-w-xs"
			/>
			<h1 class="text-4xl font-bold mb-4">Reverse.bike Firmware Tools</h1>
			<p class="text-xl text-gray-600 mb-6">
				Backup, restore, and customize Super73 ebike firmware directly from your browser.
			</p>
			<nav class="flex justify-center gap-6 text-sm">
				<a href="/advanced" class="text-blue-500 hover:underline">Advanced Tools</a>
				<a href="/firmware" class="text-blue-500 hover:underline">Custom Firmware</a>
				<a href="https://github.com/reverse-bike/sdcfw" target="_blank" rel="noopener" class="text-blue-500 hover:underline">GitHub</a>
				<a href="https://discord.gg/STvgARZYaw" target="_blank" rel="noopener" class="text-blue-500 hover:underline">Discord</a>
			</nav>
		</div>

		<!-- Browser Support Warning -->
		<div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-8">
			<div class="flex">
				<div class="shrink-0">
					<svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
						<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
					</svg>
				</div>
				<div class="ml-3">
					<p class="text-sm text-blue-700">
						<strong>Browser requirement:</strong> This tool requires Chrome, Edge, or another Chromium-based browser for WebUSB support. Works on Android with Chrome. <span class="text-blue-600">Does not work on iOS</span> (Apple doesn't allow real Chrome on iPhones/iPads).
					</p>
				</div>
			</div>
		</div>

		<!-- What You'll Need -->
		<section class="mb-12">
			<h2 class="text-2xl font-bold mb-4">What You'll Need</h2>
			<div class="bg-white border border-gray-200 rounded-lg p-6">
				<ul class="space-y-4">
					<li class="flex items-start">
						<span class="text-green-500 mr-3 mt-1">
							<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
								<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
							</svg>
						</span>
						<div>
							<strong class="text-gray-900">Raspberry Pi Debug Probe</strong>
							<span class="text-sm text-gray-500 ml-2">(Recommended)</span>
							<p class="text-gray-600 text-sm mt-1">
								A low-cost SWD debug probe that works perfectly with this tool. Available from the
								<a href="https://www.raspberrypi.com/products/debug-probe/" target="_blank" rel="noopener" class="text-blue-500 hover:underline">Raspberry Pi store</a>
								or major electronics retailers.
							</p>
						</div>
					</li>
					<li class="flex items-start">
						<span class="text-green-500 mr-3 mt-1">
							<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
								<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
							</svg>
						</span>
						<div>
							<strong class="text-gray-900">Jumper wires</strong>
							<span class="text-sm text-gray-500 ml-2">(Included with debug probe)</span>
							<p class="text-gray-600 text-sm mt-1">
								Three male-ended jumper wires to connect the debug probe to the test points.
								The GND wire will be shimmed into the white connector on the backside of the PCB, and the SW wires will be held in place ont the test points.
							</p>
						</div>
					</li>
					<li class="flex items-start">
						<span class="text-green-500 mr-3 mt-1">
							<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
								<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
							</svg>
						</span>
						<div>
							<strong class="text-gray-900">Access to test points</strong>
							<p class="text-gray-600 text-sm mt-1">
								You'll need to open the Diamond display to access the test points on the PCB inside.
							</p>
						</div>
					</li>
				</ul>

				<figure class="mt-6">
					<a href="/display.webp" target="_blank" rel="noopener" class="block">
						<img
							src="/display.webp"
							alt="Super73 Diamond display - the device that needs to be opened"
							class="w-full max-w-sm mx-auto rounded-lg border border-gray-200 hover:opacity-90 transition-opacity cursor-zoom-in"
						/>
					</a>
					<figcaption class="text-sm text-gray-500 mt-2 text-center">
						The Diamond display - open this to access the test points
					</figcaption>
				</figure>
			</div>
		</section>

		<!-- Opening the Display -->
		<section class="mb-12">
			<h2 class="text-2xl font-bold mb-4">Opening the Display</h2>
			<div class="bg-white border border-gray-200 rounded-lg p-6">
				<p class="text-gray-600 mb-6">
					Follow these steps to safely open your Diamond display and access the test points. This can be done without removing the display from your bike.
				</p>

				<div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
					<figure>
						<a href="/dd-dis-01-buttons.webp" target="_blank" rel="noopener" class="block aspect-[4/3] overflow-hidden rounded-lg border border-gray-200">
							<img
								src="/dd-dis-01-buttons.webp"
								alt="Step 1: Display buttons"
								class="w-full h-full object-cover hover:opacity-90 transition-opacity cursor-zoom-in"
							/>
						</a>
						<figcaption class="text-sm text-gray-500 mt-2">
							<span class="font-semibold text-gray-700">Step 1:</span> Remove the button cover with your fingers, or a slim piece of sturdy plastic or metal.
						</figcaption>
					</figure>

					<figure>
						<a href="/dd-dis-02-screws.webp" target="_blank" rel="noopener" class="block aspect-[4/3] overflow-hidden rounded-lg border border-gray-200">
							<img
								src="/dd-dis-02-screws.webp"
								alt="Step 2: Remove screws"
								class="w-full h-full object-cover hover:opacity-90 transition-opacity cursor-zoom-in"
							/>
						</a>
						<figcaption class="text-sm text-gray-500 mt-2">
							<span class="font-semibold text-gray-700">Step 2:</span> Remove the 6 small screws on the inner case. <span class="font-bold">Warning:</span> The inner case is connected to the PCB with a delicate ribbon cable. The cable does not need to be disconnected, but take care not to tear it.
						</figcaption>
					</figure>

					<figure>
						<a href="/dd-dis-03-cover.webp" target="_blank" rel="noopener" class="block aspect-[4/3] overflow-hidden rounded-lg border border-gray-200">
							<img
								src="/dd-dis-03-cover.webp"
								alt="Step 3: Remove cover"
								class="w-full h-full object-cover hover:opacity-90 transition-opacity cursor-zoom-in"
							/>
						</a>
						<figcaption class="text-sm text-gray-500 mt-2">
							<span class="font-semibold text-gray-700">Step 3:</span> The inner case should come off easily once screws are removed.
						</figcaption>
					</figure>

					<figure>
						<a href="/dd-dis-04-sticker.webp" target="_blank" rel="noopener" class="block aspect-[4/3] overflow-hidden rounded-lg border border-gray-200">
							<img
								src="/dd-dis-04-sticker.webp"
								alt="Step 4: Sticker location"
								class="w-full h-full object-cover hover:opacity-90 transition-opacity cursor-zoom-in"
							/>
						</a>
						<figcaption class="text-sm text-gray-500 mt-2">
							<span class="font-semibold text-gray-700">Step 4:</span> You may need to remove the yellow tape to reveal your golden test points.
						</figcaption>
					</figure>
				</div>
			</div>
		</section>

		<!-- Wiring Guide -->
		<section class="mb-12">
			<h2 class="text-2xl font-bold mb-4">Wiring Guide</h2>
			<div class="bg-white border border-gray-200 rounded-lg p-6">
				<p class="text-gray-600 mb-4">
					Connect your Raspberry Pi Debug Probe to the test points inside the display:
				</p>

				<div class="bg-gray-50 rounded-lg p-4 mb-6">
					<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
						<div class="flex items-center space-x-3">
							<span class="w-24 font-mono text-sm bg-gray-200 px-2 py-1 rounded">TP10</span>
							<span class="text-gray-400">&rarr;</span>
							<span class="font-semibold">SWDIO (SD)</span>
							<span class="w-4 h-4 rounded-full bg-yellow-400 border border-yellow-500" title="Yellow wire"></span>
						</div>
						<div class="flex items-center space-x-3">
							<span class="w-24 font-mono text-sm bg-gray-200 px-2 py-1 rounded">TP11</span>
							<span class="text-gray-400">&rarr;</span>
							<span class="font-semibold">SWCLK (SC)</span>
							<span class="w-4 h-4 rounded-full bg-orange-500 border border-orange-600" title="Orange wire"></span>
						</div>
						<div class="flex items-center space-x-3">
							<span class="w-24 font-mono text-sm bg-gray-200 px-2 py-1 rounded">Terminal 8</span>
							<span class="text-gray-400">&rarr;</span>
							<span class="font-semibold">GND</span>
							<span class="w-4 h-4 rounded-full bg-gray-800 border border-gray-900" title="Black wire"></span>
						</div>
					</div>
				</div>

				<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
					<figure>
						<a href="/debug-probe-wires.webp" target="_blank" rel="noopener" class="block">
							<img
								src="/debug-probe-wires.webp"
								alt="Raspberry Pi Debug Probe showing SWDIO (yellow), SWCLK (orange), and GND (black) wires"
								class="w-full rounded-lg border border-gray-200 hover:opacity-90 transition-opacity cursor-zoom-in"
							/>
						</a>
						<figcaption class="text-sm text-gray-500 mt-2 text-center">
							Debug probe wires: <span class="text-yellow-600 font-medium">Yellow</span> = SWDIO, <span class="text-orange-600 font-medium">Orange</span> = SWCLK, <span class="text-gray-800 font-medium">Black</span> = GND
						</figcaption>
					</figure>
					<figure>
						<a href="/test-points.webp" target="_blank" rel="noopener" class="block">
							<img
								src="/test-points.webp"
								alt="Test points inside the Diamond display showing TP10 (SWDIO) and TP11 (SWCLK)"
								class="w-full rounded-lg border border-gray-200 hover:opacity-90 transition-opacity cursor-zoom-in"
							/>
						</a>
						<figcaption class="text-sm text-gray-500 mt-2 text-center">
							Test point locations inside the display
						</figcaption>
					</figure>
					<figure>
						<a href="/terminal-8-gnd.webp" target="_blank" rel="noopener" class="block">
							<img
								src="/terminal-8-gnd.webp"
								alt="White connector showing Terminal 8 for GND connection"
								class="w-full rounded-lg border border-gray-200 hover:opacity-90 transition-opacity cursor-zoom-in"
							/>
						</a>
						<figcaption class="text-sm text-gray-500 mt-2 text-center">
							Terminal 8 on the white connector for GND
						</figcaption>
					</figure>
				</div>
			</div>
		</section>

		<!-- Step-by-Step Tutorial with Inline Tools -->
		<section class="mb-12">
			<h2 class="text-2xl font-bold mb-4">Step-by-Step Guide</h2>

			<div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
				<div class="flex">
					<div class="shrink-0">
						<svg class="h-5 w-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
							<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
						</svg>
					</div>
					<div class="ml-3">
						<p class="text-sm text-yellow-700">
							<strong>Warning:</strong> These tools provide low-level access to your device firmware. Always backup before making changes.
						</p>
					</div>
				</div>
			</div>

			<GuidedTutorial client:only="solid-js" />
		</section>
	</div>
</Layout>
